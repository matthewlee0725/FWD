之前的代码全部作废，开始重写，力求简洁，易于维护。
